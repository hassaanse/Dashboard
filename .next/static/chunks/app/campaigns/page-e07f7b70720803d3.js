(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[134],{9721:(e,a,t)=>{Promise.resolve().then(t.bind(t,32489))},32489:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>W});var s=t(95155),n=t(12115),i=t(2805),l=t(89100),o=t(47335),r=t(2432),c=t(48983),d=t(12406),h=t(27315),m=t(30910),p=t(18786),x=t(22926);t(31493);var g=t(27116);t(85869),t(91068);var u=t(22282),j=t(77740),f=t(76581);let b=e=>{let{HandleIsAddClose:a}=e,[t,i]=(0,n.useState)({campaignName:"",description:"",endDate:"",tags:"",videos:[]}),[l,o]=(0,n.useState)([]),[r,c]=(0,n.useState)([]),d=e=>{let{name:a,value:s}=e.target;i({...t,[a]:s})},h=async e=>{if(e.preventDefault(),!t.videos.length)return alert("Please upload at least one video.");try{let e=new FormData;e.append("campaignName",t.campaignName),e.append("description",t.description),e.append("endDate",t.endDate.toString()),e.append("tags",t.tags),t.videos.forEach(a=>{e.append("videos",a)}),e.append("videoOrder",JSON.stringify(l));let s=[];for(let[a,t]of e.entries())s.push({key:a,value:t instanceof File?t.name:t});if(c(s),(await fetch("https://thekoi.ca/backened/campaign/createCampaigns",{method:"POST",body:e})).ok)console.log("Campaign added successfully"),i({campaignName:"",description:"",endDate:"",tags:"",videos:[]}),o([]),a();else throw Error("Failed to add campaign")}catch(e){console.error("Error adding campaign:",e.message)}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-left",onClick:a,children:[(0,s.jsx)(f.A,{className:"mr-2 cursor-pointer"}),(0,s.jsx)("h2",{className:"font-bold mb-4 cursor-pointer",children:"Back"})]}),(0,s.jsxs)("form",{onSubmit:h,className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Add Campaign"}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"campaignName",className:"block font-semibold mb-2",children:"Campaign Name"}),(0,s.jsx)("input",{type:"text",id:"campaignName",name:"campaignName",value:t.campaignName,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"description",className:"block font-semibold mb-2",children:"Description"}),(0,s.jsx)("textarea",{id:"description",name:"description",value:t.description,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500",rows:"4"})]}),(0,s.jsxs)("div",{className:"flex mb-4",children:[(0,s.jsxs)("div",{className:"w-1/2 mr-2",children:[(0,s.jsx)("label",{htmlFor:"endDate",className:"block font-semibold mb-2",children:"End Date"}),(0,s.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:t.endDate,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,s.jsxs)("div",{className:"w-1/2 ml-2",children:[(0,s.jsx)("label",{htmlFor:"tags",className:"block font-semibold mb-2",children:"Tags"}),(0,s.jsx)("input",{type:"text",id:"tags",name:"tags",value:t.tags,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"videos",className:"block font-semibold mb-2",children:"Video Upload (First Video Gets Priority)"}),(0,s.jsx)("input",{type:"file",id:"videos",name:"videos",accept:"video/*",onChange:e=>{let a=Array.from(e.target.files),s=a.map((e,a)=>({name:e.name,order:t.videos.length+a}));i(e=>({...e,videos:[...e.videos,...a]})),o(e=>[...e,...s])},className:"hidden",multiple:!0}),(0,s.jsx)("label",{htmlFor:"videos",className:"block cursor-pointer bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Choose Files"}),(0,s.jsx)("ul",{className:"mt-2",children:t.videos.map((e,a)=>(0,s.jsx)("li",{className:"text-sm",children:0===a?"â­ ".concat(e.name):e.name},a))})]}),(0,s.jsx)("button",{type:"submit",className:"mt-5 w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 focus:outline-none",children:"Submit"})]})]})};var v=t(19128),y=t(7831),A=t(82802),C=t.n(A),N=t(43619),k=t(76046);let w=e=>{let{videos:a}=e,t=e=>{let{videoId:a,title:t,path:n,views:i}=e;return(0,s.jsxs)("div",{className:"video-card",style:S.card,children:[(0,s.jsx)("h3",{children:t}),(0,s.jsxs)("video",{controls:!0,width:"400",style:S.video,children:[(0,s.jsx)("source",{src:n,type:"video/mp4"}),"Your browser does not support the video tag."]}),(0,s.jsxs)("p",{children:[i," views"]})]},a)};return(0,s.jsx)("div",{className:"video-gallery",style:S.gallery,children:a.map(e=>(0,s.jsx)(t,{videoId:e.videoId,title:e.title,path:"https://thekoi.ca/backened/"+e.path,views:e.views},e.videoId))})},S={gallery:{display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"center"},card:{border:"1px solid #ccc",borderRadius:"8px",padding:"16px",textAlign:"center",width:"400px"},video:{width:"100%",height:"auto"}},D=e=>{let{campaignId:a,onBack:t}=e,[i,l]=(0,n.useState)([]),[o,r]=(0,n.useState)(!0);return((0,k.useRouter)(),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://thekoi.ca/backened/campaign/videowithID",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:a})}),t=await e.json();console.log("data of videoID is : "),l(t),r(!1)}catch(e){console.error("Error fetching videos:",e),r(!1)}})()},[]),o)?(0,s.jsx)("p",{children:"Loading videos..."}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-left",onClick:t,children:[(0,s.jsx)(f.A,{className:"mr-2 cursor-pointer"}),(0,s.jsx)("h2",{className:"font-bold mb-4 cursor-pointer",children:"Back"})]}),(0,s.jsx)(w,{videos:i})]})};function P(e){let{onBack:a}=e,[t,i]=(0,n.useState)(),[f,A]=(0,n.useState)({}),[k,w]=(0,n.useState)({}),S=e=>{w(a=>({...a,[e]:!a[e]})),k[e]?$(e):Q(e)},[P,W]=(0,n.useState)(0),[I,O]=(0,n.useState)(10),[F,T]=(0,n.useState)([]),[E,L]=(0,n.useState)([]),[M,_]=(0,n.useState)(!0),[z,H]=(0,n.useState)(!1),[J,R]=(0,n.useState)(null),[U,V]=(0,n.useState)(""),[B,G]=(0,n.useState)(""),[Y,q]=(0,n.useState)(!1);(0,n.useEffect)(()=>{Z()},[z]),(0,n.useEffect)(()=>{X(U)},[U]);let K=()=>{q(!1)},X=e=>{e?T(F.filter(a=>a.campaignName.toLowerCase().includes(e.toLowerCase())||a.description.toLowerCase().includes(e.toLowerCase())||a.campaignId.toString().toLowerCase().includes(e.toLowerCase()))):T(E)},Z=()=>{fetch("https://thekoi.ca/backened/campaign/getAllCompaigns").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>(console.log("Data is",e),T(e),L(e),_(!1),e)).catch(e=>{console.log(e)})},Q=e=>{fetch("https://thekoi.ca/backened/campaign/activated",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}).then(e=>{console.log("data",e),Z()}).then(e=>{(0,y.M8)("Activated Campaign",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},$=e=>{i(e),fetch("https://thekoi.ca/backened/campaign/deactivated",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}).then(e=>{console.log("data",e),Z()}).then(e=>{(0,y.M8)("Deactivated Campaign",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},ee=e=>{fetch("https://thekoi.ca/backened/campaign/CreateNotification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"Watch Campaign "+{row:e},body:"Complete watching this campaign to rank up!"})}).then(e=>{console.log("data",e),Z()}).then(e=>{(0,y.M8)("Successfuly send notification",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},ea=e=>{console.log("Edit Record is : ",e),R(null),H(!0)},[et,es]=(0,n.useState)(!1),[en,ei]=(0,n.useState)(null),el=e=>{ei(e),es(!0)},eo=e=>{console.log("Delete Record is : ",e),(0,g.ZX)({title:"Confirm to submit",message:"Are you sure to do this.",buttons:[{label:"Yes",onClick:()=>er(e)},{label:"No"}]})},er=e=>{fetch("https://thekoi.ca/backened/campaign/deleteCompaign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e.campaignId})}).then(e=>{console.log("data",e),Z()}).then(e=>{(0,y.M8)("Campaign is Deleted!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},ec=e=>{let a=new Date(e);return(0,l.GP)(a,"MMMM d, yyyy h:mm a")};return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(y.n,{maxSnack:3,children:et?(0,s.jsx)(D,{campaignId:en,handleBackToTable:()=>{es(!1)}}):(0,s.jsx)(s.Fragment,{children:z?(0,s.jsx)(b,{Details:!0,HandleIsAddClose:()=>{H(!1)}}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"font-bold mb-4",children:"Campaigns"}),(0,s.jsxs)("div",{className:"flex justify-between ",children:[(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"text",placeholder:"Search Campaigns",value:U,onChange:e=>{V(e.target.value)},className:"mb-2 px-2 py-2 rounded-lg border-2"})}),(0,s.jsx)(u.A,{variant:"outlined",className:"mb-2",onClick:()=>ea(),startIcon:(0,s.jsx)(j.A,{}),children:"Add Campaign"})]}),(0,s.jsx)(d.A,{sx:{maxHeight:440},children:(0,s.jsxs)(o.A,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,s.jsx)(h.A,{children:(0,s.jsxs)(p.A,{children:[(0,s.jsx)(c.A,{align:"center",style:{minWidth:70},children:"ID"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"NAME"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Description"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Campaign"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Views"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Creation Date"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Activate Campaign"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Push Notification"}),(0,s.jsx)(c.A,{align:"center",style:{minWidth:170},children:"Delete Campaign"})]})}),(0,s.jsx)(r.A,{children:F.slice(P*I,P*I+I).map((e,a)=>(0,s.jsxs)(p.A,{hover:!0,role:"checkbox",tabIndex:-1,children:[(0,s.jsx)(c.A,{align:"center",children:e.campaignId},a),(0,s.jsx)(c.A,{align:"center",children:e.campaignName},a),(0,s.jsx)(c.A,{align:"center",children:e.description},a),(0,s.jsx)(c.A,{align:"center",children:(0,s.jsx)(u.A,{onClick:()=>el(e.campaignId),variant:"contained",children:"Play Video"})},a),(0,s.jsx)(N.A,{open:Y,onClose:K,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"-1rem",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,s.jsx)(C(),{url:B,controls:!0}),(0,s.jsx)(u.A,{onClick:K,style:{marginTop:"1rem"},className:"bg-red-600 text-white",children:"Close"})]})}),(0,s.jsx)(c.A,{align:"center",children:e.views},a),(0,s.jsx)(c.A,{align:"center",children:ec(e.createdAt)},a),(0,s.jsx)(c.A,{align:"center",children:(0,s.jsx)("div",{className:"flex justify-center gap-2",children:(0,s.jsx)(u.A,{onClick:()=>S(e.campaignId),variant:"contained",color:k[e.campaignId]?"inherit":"success",children:k[e.campaignId]?"Deactivate":"Activate"})},e.campaignId)},a),(0,s.jsx)(c.A,{align:"center",children:(0,s.jsx)("div",{className:"flex justify-center gap-2",children:(0,s.jsx)("div",{className:"cursor-pointer text-green-500 ",onClick:()=>{ee(e.campaignName)},children:(0,s.jsx)(v.A,{})})})},a),(0,s.jsx)(c.A,{align:"center",children:(0,s.jsx)(u.A,{onClick:()=>eo(e),variant:"contained",color:"error",startIcon:(0,s.jsx)(x.A,{}),children:"Delete"})},a)]},e.code))})]})}),(0,s.jsx)(m.A,{rowsPerPageOptions:[10,25,100],component:"div",count:F.length,rowsPerPage:I,page:P,onPageChange:(e,a)=>{W(a)},onRowsPerPageChange:e=>{O(+e.target.value),W(0)}})]})})})})}function W(){return(0,s.jsx)(i.default,{children:(0,s.jsx)(P,{})})}},2805:(e,a,t)=>{"use strict";t.d(a,{default:()=>_});var s=t(95155),n=t(12115),i=t(81996),l=t.n(i),o=t(11451),r=t(63592),c=t(20457),d=t(2241),h=t(19579),m=t(894),p=t(4918),x=t(41983),g=t(36017),u=t(2091),j=t(60391),f=t(8266),b=t(46805),v=t(10810),y=t(35256),A=t(46552),C=t(94856),N=t(5565);let k={src:"/_next/static/media/Dashboadlogo.8c9740a7.gif",height:150,width:150,blurWidth:0,blurHeight:0};var w=t(2215),S=t(46876),D=t(65509),P=t(62982),W=t(82354),I=t(83746),O=t(78481),F=t(64108),T=t(76046),E=t(56119),L=t(2615);function M(e){let a=(0,T.useRouter)(),t=(0,T.usePathname)();console.log("Pathname is ",t);let{window:i,children:l}=e,[M,_]=(0,n.useState)(!1),[z,H]=(0,n.useState)(!1),[J,R]=(0,n.useState)(!1),{data:U}=(0,L.useSession)({required:!0,onUnauthenticated(){(0,T.redirect)("/")}});U&&console.log("Session User ",U.user);let V=async()=>{await (0,L.signOut)({redirect:!1}),a.push("https://thekoi.ca/")},B=(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.A,{className:"p-[-20px] m-[-8px]",children:[(0,s.jsx)(N.default,{className:"ml-[-20px]",src:k,height:80,width:80,alt:"Logo"}),(0,s.jsx)(v.A,{variant:"h4",noWrap:!0,component:"div",children:"TheKoi"})]}),(0,s.jsx)(d.A,{}),(0,s.jsxs)(p.A,{children:[["Dashboard","Campaigns","Users","Communications"].map((e,n)=>(0,s.jsx)(x.Ay,{disablePadding:!0,className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{a.push("/"+e.toLowerCase())},children:(0,s.jsxs)(g.A,{children:[(0,s.jsxs)(u.A,{className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",children:[0===n&&(0,s.jsx)(w.A,{}),1===n&&(0,s.jsx)(S.A,{}),2===n&&(0,s.jsx)(D.A,{}),3===n&&(0,s.jsx)(P.A,{})]}),(0,s.jsx)(j.A,{primary:e})]})},e)),(0,s.jsx)(x.Ay,{disablePadding:!0,onClick:()=>{H(!z)},className:t.startsWith("/help")?"text-sky-600 bg-slate-100":"text-slate-700",children:(0,s.jsxs)(g.A,{children:[(0,s.jsx)(u.A,{className:t.startsWith("/help")?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{a.push("/help")},children:(0,s.jsx)(W.A,{})}),(0,s.jsx)(j.A,{primary:"Help"}),z?(0,s.jsx)(C.A,{}):(0,s.jsx)(A.A,{})]})})]}),(0,s.jsx)(d.A,{}),(0,s.jsx)(y.A,{in:z,timeout:"auto",unmountOnExit:!0,children:(0,s.jsx)(p.A,{className:"ml-4",children:["Support","Contact","Help"].map((e,n)=>(0,s.jsx)(x.Ay,{disablePadding:!0,className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{a.push("/"+e.toLowerCase())},children:(0,s.jsxs)(g.A,{children:[(0,s.jsxs)(u.A,{className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",children:[0===n&&(0,s.jsx)(I.A,{}),1===n&&(0,s.jsx)(O.A,{}),2===n&&(0,s.jsx)(F.A,{})]}),(0,s.jsx)(j.A,{primary:e})]})},e))})})]});return(0,s.jsxs)(r.A,{sx:{display:"flex"},children:[(0,s.jsx)(c.Ay,{}),(0,s.jsx)(o.A,{position:"fixed",sx:{width:{sm:"calc(100% - ".concat(240,"px)")},ml:{sm:"".concat(240,"px")},bgcolor:"#FFFFFF",color:"#2f2f2f"},children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)(b.A,{children:[(0,s.jsx)(m.A,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:()=>{J||_(!M)},sx:{mr:2,display:{sm:"none"}},children:(0,s.jsx)(f.A,{})}),(0,s.jsx)(v.A,{variant:"h6",noWrap:!0,component:"div",children:"Dashboard"})]}),(0,s.jsx)("div",{className:"mt-3 mr-3 cursor-pointer",onClick:()=>V(),children:(0,s.jsxs)(v.A,{variant:"h6",noWrap:!0,component:"div",children:[(0,s.jsx)(E.A,{})," Logout"]})})]})}),(0,s.jsxs)(r.A,{component:"nav",sx:{width:{sm:240},flexShrink:{sm:0}},"aria-label":"mailbox folders",children:[(0,s.jsx)(h.Ay,{container:void 0!==i?()=>i().document.body:void 0,variant:"temporary",open:M,onTransitionEnd:()=>{R(!1)},onClose:()=>{R(!0),_(!1)},ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:B}),(0,s.jsx)(h.Ay,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},open:!0,children:B})]}),(0,s.jsxs)(r.A,{component:"main",sx:{flexGrow:1,p:3,width:{sm:"calc(100% - ".concat(240,"px)")}},children:[(0,s.jsx)(b.A,{}),(0,s.jsx)("main",{children:l})," "]})]})}M.propTypes={window:l().func,children:l().node};let _=M}},e=>{var a=a=>e(e.s=a);e.O(0,[5740,2615,4399,9675,7831,5714,7898,6937,5948,8441,1517,7358],()=>a(9721)),_N_E=e.O()}]);