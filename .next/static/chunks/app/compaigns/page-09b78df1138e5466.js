(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[844],{75913:(e,s,t)=>{Promise.resolve().then(t.bind(t,67073))},67073:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>W});var a=t(95155),n=t(12115),i=t(2805),l=t(89100),o=t(46106),r=t(47335),c=t(2432),d=t(48983),h=t(12406),m=t(27315),p=t(30910),x=t(18786),g=t(22926);t(31493);var u=t(27116);t(85869),t(91068);var j=t(22282),f=t(77740),b=t(76581);let v=e=>{let{HandleIsAddClose:s}=e,[t,i]=(0,n.useState)({campaignName:"",description:"",endDate:"",tags:"",videos:[]}),[l,o]=(0,n.useState)([]),[r,c]=(0,n.useState)([]),d=e=>{let{name:s,value:a}=e.target;i({...t,[s]:a})},h=async e=>{if(e.preventDefault(),!t.videos.length)return alert("Please upload at least one video.");try{let e=new FormData;e.append("campaignName",t.campaignName),e.append("description",t.description),e.append("endDate",t.endDate.toString()),e.append("tags",t.tags),t.videos.forEach(s=>{e.append("videos",s)}),e.append("videoOrder",JSON.stringify(l));let a=[];for(let[s,t]of e.entries())a.push({key:s,value:t instanceof File?t.name:t});if(c(a),(await fetch("https://thekoi.ca/backened/campaign/createCampaigns",{method:"POST",body:e})).ok)console.log("Campaign added successfully"),i({campaignName:"",description:"",endDate:"",tags:"",videos:[]}),o([]),s();else throw Error("Failed to add campaign")}catch(e){console.error("Error adding campaign:",e.message)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-left",onClick:s,children:[(0,a.jsx)(b.A,{className:"mr-2 cursor-pointer"}),(0,a.jsx)("h2",{className:"font-bold mb-4 cursor-pointer",children:"Back"})]}),(0,a.jsxs)("form",{onSubmit:h,className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-lg",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Add Campaign"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"campaignName",className:"block font-semibold mb-2",children:"Campaign Name"}),(0,a.jsx)("input",{type:"text",id:"campaignName",name:"campaignName",value:t.campaignName,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"description",className:"block font-semibold mb-2",children:"Description"}),(0,a.jsx)("textarea",{id:"description",name:"description",value:t.description,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500",rows:"4"})]}),(0,a.jsxs)("div",{className:"flex mb-4",children:[(0,a.jsxs)("div",{className:"w-1/2 mr-2",children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"block font-semibold mb-2",children:"End Date"}),(0,a.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:t.endDate,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"w-1/2 ml-2",children:[(0,a.jsx)("label",{htmlFor:"tags",className:"block font-semibold mb-2",children:"Tags"}),(0,a.jsx)("input",{type:"text",id:"tags",name:"tags",value:t.tags,onChange:d,className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:border-blue-500"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"videos",className:"block font-semibold mb-2",children:"Video Upload (First Video Gets Priority)"}),(0,a.jsx)("input",{type:"file",id:"videos",name:"videos",accept:"video/*",onChange:e=>{let s=Array.from(e.target.files),a=s.map((e,s)=>({name:e.name,order:t.videos.length+s}));i(e=>({...e,videos:[...e.videos,...s]})),o(e=>[...e,...a])},className:"hidden",multiple:!0}),(0,a.jsx)("label",{htmlFor:"videos",className:"block cursor-pointer bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Choose Files"}),(0,a.jsx)("ul",{className:"mt-2",children:t.videos.map((e,s)=>(0,a.jsx)("li",{className:"text-sm",children:0===s?"â­ ".concat(e.name):e.name},s))})]}),(0,a.jsx)("button",{type:"submit",className:"mt-5 w-full bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 focus:outline-none",children:"Submit"})]})]})};var y=t(19128),A=t(7831),C=t(82802),N=t.n(C),w=t(43619);let k=e=>{let{videos:s}=e,t=e=>{let{videoId:s,title:t,path:n,views:i}=e;return(0,a.jsxs)("div",{className:"video-card",style:S.card,children:[(0,a.jsx)("h3",{children:t}),(0,a.jsxs)("video",{controls:!0,width:"400",style:S.video,children:[(0,a.jsx)("source",{src:n,type:"video/mp4"}),"Your browser does not support the video tag."]}),(0,a.jsxs)("p",{children:[i," views"]})]},s)};return(0,a.jsx)("div",{className:"video-gallery",style:S.gallery,children:s.map(e=>(0,a.jsx)(t,{videoId:e.videoId,title:e.title,path:"https://thekoi.ca/backened/"+e.path,views:e.views},e.videoId))})},S={gallery:{display:"flex",flexWrap:"wrap",gap:"20px",justifyContent:"center"},card:{border:"1px solid #ccc",borderRadius:"8px",padding:"16px",textAlign:"center",width:"400px"},video:{width:"100%",height:"auto"}},D=e=>{let{campaignId:s,onBack:t}=e,[i,l]=(0,n.useState)([]),[o,r]=(0,n.useState)(!0);return((0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("https://thekoi.ca/backened/campaign/videowithID",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:s})}),t=await e.json();console.log("data of videoID is : "),l(t),r(!1)}catch(e){console.error("Error fetching videos:",e),r(!1)}})()},[]),o)?(0,a.jsx)("p",{children:"Loading videos..."}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-left",onClick:t,children:[(0,a.jsx)(b.A,{className:"mr-2 cursor-pointer"}),(0,a.jsx)("h2",{className:"font-bold mb-4 cursor-pointer",children:"Back"})]}),(0,a.jsx)(k,{videos:i})]})};function P(){let[e,s]=(0,n.useState)(),[t,i]=(0,n.useState)({}),[b,C]=(0,n.useState)({}),k=e=>{C(s=>({...s,[e]:!s[e]})),b[e]?Q(e):Z(e)},[S,P]=(0,n.useState)(0),[W,I]=(0,n.useState)(10),[O,F]=(0,n.useState)([]),[T,E]=(0,n.useState)([]),[L,M]=(0,n.useState)(!0),[_,z]=(0,n.useState)(!1),[H,J]=(0,n.useState)(null),[R,U]=(0,n.useState)(""),[V,B]=(0,n.useState)(""),[G,Y]=(0,n.useState)(!1);(0,n.useEffect)(()=>{X()},[_]),(0,n.useEffect)(()=>{K(R)},[R]);let q=()=>{Y(!1)},K=e=>{e?F(O.filter(s=>s.campaignName.toLowerCase().includes(e.toLowerCase())||s.description.toLowerCase().includes(e.toLowerCase())||s.campaignId.toString().toLowerCase().includes(e.toLowerCase()))):F(T)},X=()=>{fetch("https://thekoi.ca/backened/campaign/getAllCompaigns").then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>(console.log("Data is",e),F(e),E(e),M(!1),e)).catch(e=>{console.log(e)})},Z=e=>{fetch("https://thekoi.ca/backened/campaign/activated",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}).then(e=>{console.log("data",e),X()}).then(e=>{(0,A.M8)("Activated Campaign",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},Q=e=>{s(e),fetch("https://thekoi.ca/backened/campaign/deactivated",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e})}).then(e=>{console.log("data",e),X()}).then(e=>{(0,A.M8)("Deactivated Campaign",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},$=e=>{fetch("https://thekoi.ca/backened/campaign/CreateNotification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"Watch Campaign "+{row:e},body:"Complete watching this campaign to rank up!"})}).then(e=>{console.log("data",e),X()}).then(e=>{(0,A.M8)("Successfuly send notification",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},ee=e=>{console.log("Edit Record is : ",e),J(null),z(!0)},[es,et]=(0,n.useState)(!1),[ea,en]=(0,n.useState)(null),ei=e=>{en(e),et(!0)},el=e=>{console.log("Delete Record is : ",e),(0,u.ZX)({title:"Confirm to submit",message:"Are you sure to do this.",buttons:[{label:"Yes",onClick:()=>eo(e)},{label:"No"}]})},eo=e=>{fetch("https://thekoi.ca/backened/campaign/deleteCompaign",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignId:e.campaignId})}).then(e=>{console.log("data",e),X()}).then(e=>{(0,A.M8)("Campaign is Deleted!",{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},style:{backgroundColor:"#00ff00",color:"#ffffff",fontWeight:"bold"}})})},er=e=>{let s=new Date(e);return(0,l.GP)(s,"MMMM d, yyyy h:mm a")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.n,{maxSnack:3}),es?(0,a.jsx)(D,{campaignId:ea,handleBackToTable:()=>{et(!1)}}):(0,a.jsx)(a.Fragment,{children:_?(0,a.jsx)(v,{HandleIsAddClose:()=>{z(!1)}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{className:"font-bold mb-4",children:"Compaigns"}),(0,a.jsxs)("div",{className:"flex justify-between ",children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",placeholder:"Search Compaigns",value:R,onChange:e=>{U(e.target.value)},className:"mb-2 px-2 py-2 rounded-lg border-2"})}),(0,a.jsx)(j.A,{variant:"outlined",className:"mb-2",onClick:()=>ee(),startIcon:(0,a.jsx)(f.A,{}),children:"Add Compaign"})]}),(0,a.jsxs)(o.A,{sx:{width:"100%",overflow:"hidden"},children:[(0,a.jsx)(h.A,{sx:{maxHeight:440},children:(0,a.jsxs)(r.A,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,a.jsx)(m.A,{children:(0,a.jsxs)(x.A,{children:[(0,a.jsx)(d.A,{align:"center",style:{minWidth:70},children:"ID"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"NAME"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Description"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Compaign"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Views"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Creation Date"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Activate Compaign"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Push Notification"}),(0,a.jsx)(d.A,{align:"center",style:{minWidth:170},children:"Delete Compaign"})]})}),(0,a.jsx)(c.A,{children:O.slice(S*W,S*W+W).map((e,s)=>(0,a.jsxs)(x.A,{hover:!0,role:"checkbox",tabIndex:-1,children:[(0,a.jsx)(d.A,{align:"center",children:e.campaignId},s),(0,a.jsx)(d.A,{align:"center",children:e.campaignName},s),(0,a.jsx)(d.A,{align:"center",children:e.description},s),(0,a.jsx)(d.A,{align:"center",children:(0,a.jsx)(j.A,{onClick:()=>ei(e.campaignId),variant:"contained",children:"Play Video"})},s),(0,a.jsx)(w.A,{open:G,onClose:q,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"-1rem",alignItems:"center",justifyContent:"center",height:"100%"},children:[(0,a.jsx)(N(),{url:V,controls:!0}),(0,a.jsx)(j.A,{onClick:q,style:{marginTop:"1rem"},className:"bg-red-600 text-white",children:"Close"})]})}),(0,a.jsx)(d.A,{align:"center",children:e.views},s),(0,a.jsx)(d.A,{align:"center",children:er(e.createdAt)},s),(0,a.jsx)(d.A,{align:"center",children:(0,a.jsx)("div",{className:"flex justify-center gap-2",children:(0,a.jsx)(j.A,{onClick:()=>k(e.campaignId),variant:"contained",color:b[e.campaignId]?"inherit":"success",children:b[e.campaignId]?"Deactivate":"Activate"})},e.campaignId)},s),(0,a.jsx)(d.A,{align:"center",children:(0,a.jsx)("div",{className:"flex justify-center gap-2",children:(0,a.jsx)("div",{className:"cursor-pointer text-green-500 ",onClick:()=>{$(e.campaignName)},children:(0,a.jsx)(y.A,{})})})},s),(0,a.jsx)(d.A,{align:"center",children:(0,a.jsx)(j.A,{onClick:()=>el(e),variant:"contained",color:"error",startIcon:(0,a.jsx)(g.A,{}),children:"Delete"})},s)]},e.code))})]})}),(0,a.jsx)(p.A,{rowsPerPageOptions:[10,25,100],component:"div",count:O.length,rowsPerPage:W,page:S,onPageChange:(e,s)=>{P(s)},onRowsPerPageChange:e=>{I(+e.target.value),P(0)}})]}),(0,a.jsxs)("div",{children:["Active Campaign Id ",e]})]})})]})}function W(){return(0,a.jsx)(i.default,{children:(0,a.jsx)(P,{})})}},2805:(e,s,t)=>{"use strict";t.d(s,{default:()=>_});var a=t(95155),n=t(12115),i=t(81996),l=t.n(i),o=t(11451),r=t(63592),c=t(20457),d=t(2241),h=t(19579),m=t(894),p=t(4918),x=t(41983),g=t(36017),u=t(2091),j=t(60391),f=t(8266),b=t(46805),v=t(10810),y=t(35256),A=t(46552),C=t(94856),N=t(5565);let w={src:"/_next/static/media/Dashboadlogo.8c9740a7.gif",height:150,width:150,blurWidth:0,blurHeight:0};var k=t(2215),S=t(46876),D=t(65509),P=t(62982),W=t(82354),I=t(83746),O=t(78481),F=t(64108),T=t(76046),E=t(56119),L=t(2615);function M(e){let s=(0,T.useRouter)(),t=(0,T.usePathname)();console.log("Pathname is ",t);let{window:i,children:l}=e,[M,_]=(0,n.useState)(!1),[z,H]=(0,n.useState)(!1),[J,R]=(0,n.useState)(!1),{data:U}=(0,L.useSession)({required:!0,onUnauthenticated(){(0,T.redirect)("/")}});U&&console.log("Session User ",U.user);let V=()=>{(0,L.signOut)()},B=(0,a.jsxs)("div",{children:[(0,a.jsxs)(b.A,{className:"p-[-20px] m-[-8px]",children:[(0,a.jsx)(N.default,{className:"ml-[-20px]",src:w,height:80,width:80,alt:"Logo"}),(0,a.jsx)(v.A,{variant:"h4",noWrap:!0,component:"div",children:"TheKoi"})]}),(0,a.jsx)(d.A,{}),(0,a.jsxs)(p.A,{children:[["Dashboard","Compaigns","Users","Communications"].map((e,n)=>(0,a.jsx)(x.Ay,{disablePadding:!0,className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{s.push("/"+e.toLowerCase())},children:(0,a.jsxs)(g.A,{children:[(0,a.jsxs)(u.A,{className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",children:[0===n&&(0,a.jsx)(k.A,{}),1===n&&(0,a.jsx)(S.A,{}),2===n&&(0,a.jsx)(D.A,{}),3===n&&(0,a.jsx)(P.A,{})]}),(0,a.jsx)(j.A,{primary:e})]})},e)),(0,a.jsx)(x.Ay,{disablePadding:!0,onClick:()=>{H(!z)},className:t.startsWith("/help")?"text-sky-600 bg-slate-100":"text-slate-700",children:(0,a.jsxs)(g.A,{children:[(0,a.jsx)(u.A,{className:t.startsWith("/help")?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{s.push("/help")},children:(0,a.jsx)(W.A,{})}),(0,a.jsx)(j.A,{primary:"Help"}),z?(0,a.jsx)(C.A,{}):(0,a.jsx)(A.A,{})]})})]}),(0,a.jsx)(d.A,{}),(0,a.jsx)(y.A,{in:z,timeout:"auto",unmountOnExit:!0,children:(0,a.jsx)(p.A,{className:"ml-4",children:["Support","Contact","Help"].map((e,n)=>(0,a.jsx)(x.Ay,{disablePadding:!0,className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",onClick:()=>{s.push("/"+e.toLowerCase())},children:(0,a.jsxs)(g.A,{children:[(0,a.jsxs)(u.A,{className:t.startsWith("/"+e.toLowerCase())?"text-sky-600 bg-slate-100":"text-slate-700",children:[0===n&&(0,a.jsx)(I.A,{}),1===n&&(0,a.jsx)(O.A,{}),2===n&&(0,a.jsx)(F.A,{})]}),(0,a.jsx)(j.A,{primary:e})]})},e))})})]});return(0,a.jsxs)(r.A,{sx:{display:"flex"},children:[(0,a.jsx)(c.Ay,{}),(0,a.jsx)(o.A,{position:"fixed",sx:{width:{sm:"calc(100% - ".concat(240,"px)")},ml:{sm:"".concat(240,"px")},bgcolor:"#FFFFFF",color:"#2f2f2f"},children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(b.A,{children:[(0,a.jsx)(m.A,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:()=>{J||_(!M)},sx:{mr:2,display:{sm:"none"}},children:(0,a.jsx)(f.A,{})}),(0,a.jsx)(v.A,{variant:"h6",noWrap:!0,component:"div",children:"Dashboard"})]}),(0,a.jsx)("div",{className:"mt-3 mr-3 cursor-pointer",onClick:()=>V(),children:(0,a.jsxs)(v.A,{variant:"h6",noWrap:!0,component:"div",children:[(0,a.jsx)(E.A,{})," Logout"]})})]})}),(0,a.jsxs)(r.A,{component:"nav",sx:{width:{sm:240},flexShrink:{sm:0}},"aria-label":"mailbox folders",children:[(0,a.jsx)(h.Ay,{container:void 0!==i?()=>i().document.body:void 0,variant:"temporary",open:M,onTransitionEnd:()=>{R(!1)},onClose:()=>{R(!0),_(!1)},ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},children:B}),(0,a.jsx)(h.Ay,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:240}},open:!0,children:B})]}),(0,a.jsxs)(r.A,{component:"main",sx:{flexGrow:1,p:3,width:{sm:"calc(100% - ".concat(240,"px)")}},children:[(0,a.jsx)(b.A,{}),(0,a.jsx)("main",{children:l})," "]})]})}M.propTypes={window:l().func,children:l().node};let _=M}},e=>{var s=s=>e(e.s=s);e.O(0,[740,615,399,675,898,831,855,806,948,441,517,358],()=>s(75913)),_N_E=e.O()}]);